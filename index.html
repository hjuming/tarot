<!DOCTYPE html>
<html lang="zh-Hant" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>線上塔羅神諭 - 免費塔羅牌占卜 & 78張牌義詳解 | 探索自我・洞見未來</title>
    <meta name="description" content="探索線上塔羅神諭，您的免費線上塔羅牌占卜工具。提供78張塔羅牌正逆位詳解、因果與時間之流牌陣分析。透過塔羅認識自我，洞見未來，解決生活問題。">
    <link rel="canonical" href="https://tarot-c0p.pages.dev/">
    <meta property="og:title" content="線上塔羅神諭 - 免費塔羅牌占卜 & 78張牌義詳解">
    <meta property="og:description" content="提供專業的線上塔羅牌占卜與完整的78張牌義解析，幫助您探索內心、解決困惑。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tarot-c0p.pages.dev/">
    <meta property="og:image" content="https://i.urusai.cc/yVqvp.jpeg"> <!-- 使用太陽牌作為預覽圖 -->

    <!-- Fonts and Scripts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- JSON-LD Structured Data for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "WebSite",
          "url": "https://tarot-c0p.pages.dev/",
          "name": "線上塔羅神諭",
          "description": "免費的線上塔羅牌占卜與78張牌義詳解，幫助您探索自我、洞見未來。"
        },
        {
          "@type": "BreadcrumbList",
          "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "name": "首頁",
            "item": "https://tarot-c0p.pages.dev/"
          }]
        },
        {
          "@type": "ItemList",
          "name": "78張塔羅牌義",
          "description": "完整78張塔羅牌的牌義列表，包含大阿爾克那與四組小爾克那。",
          "itemListElement": [
            {"@type": "ListItem", "position": 1, "name": "愚人"},
            {"@type": "ListItem", "position": 2, "name": "魔術師"},
            {"@type": "ListItem", "position": 3, "name": "女祭司"},
            {"@type": "ListItem", "position": 4, "name": "皇后"},
            {"@type": "ListItem", "position": 5, "name": "皇帝"},
            {"@type": "ListItem", "position": 6, "name": "教宗"},
            {"@type": "ListItem", "position": 7, "name": "戀人"},
            {"@type": "ListItem", "position": 8, "name": "戰車"},
            {"@type": "ListItem", "position": 9, "name": "力量"},
            {"@type": "ListItem", "position": 10, "name": "隱士"},
            {"@type": "ListItem", "position": 11, "name": "命運之輪"},
            {"@type": "ListItem", "position": 12, "name": "正義"},
            {"@type": "ListItem", "position": 13, "name": "吊人"},
            {"@type": "ListItem", "position": 14, "name": "死神"},
            {"@type": "ListItem", "position": 15, "name": "節制"},
            {"@type": "ListItem", "position": 16, "name": "惡魔"},
            {"@type": "ListItem", "position": 17, "name": "塔"},
            {"@type": "ListItem", "position": 18, "name": "星星"},
            {"@type": "ListItem", "position": 19, "name": "月亮"},
            {"@type": "ListItem", "position": 20, "name": "太陽"},
            {"@type": "ListItem", "position": 21, "name": "審判"},
            {"@type": "ListItem", "position": 22, "name": "世界"},
            {"@type": "ListItem", "position": 23, "name": "權杖一"},
            {"@type": "ListItem", "position": 24, "name": "權杖二"},
            {"@type": "ListItem", "position": 25, "name": "權杖三"},
            {"@type": "ListItem", "position": 26, "name": "權杖四"},
            {"@type": "ListItem", "position": 27, "name": "權杖五"},
            {"@type": "ListItem", "position": 28, "name": "權杖六"},
            {"@type": "ListItem", "position": 29, "name": "權杖七"},
            {"@type": "ListItem", "position": 30, "name": "權杖八"},
            {"@type": "ListItem", "position": 31, "name": "權杖九"},
            {"@type": "ListItem", "position": 32, "name": "權杖十"},
            {"@type": "ListItem", "position": 33, "name": "權杖侍者"},
            {"@type": "ListItem", "position": 34, "name": "權杖騎士"},
            {"@type": "ListItem", "position": 35, "name": "權杖王后"},
            {"@type": "ListItem", "position": 36, "name": "權杖國王"},
            {"@type": "ListItem", "position": 37, "name": "聖杯一"},
            {"@type": "ListItem", "position": 38, "name": "聖杯二"},
            {"@type": "ListItem", "position": 39, "name": "聖杯三"},
            {"@type": "ListItem", "position": 40, "name": "聖杯四"},
            {"@type": "ListItem", "position": 41, "name": "聖杯五"},
            {"@type": "ListItem", "position": 42, "name": "聖杯六"},
            {"@type": "ListItem", "position": 43, "name": "聖杯七"},
            {"@type": "ListItem", "position": 44, "name": "聖杯八"},
            {"@type": "ListItem", "position": 45, "name": "聖杯九"},
            {"@type": "ListItem", "position": 46, "name": "聖杯十"},
            {"@type": "ListItem", "position": 47, "name": "聖杯侍者"},
            {"@type": "ListItem", "position": 48, "name": "聖杯騎士"},
            {"@type": "ListItem", "position": 49, "name": "聖杯王后"},
            {"@type": "ListItem", "position": 50, "name": "聖杯國王"},
            {"@type": "ListItem", "position": 51, "name": "寶劍一"},
            {"@type": "ListItem", "position": 52, "name": "寶劍二"},
            {"@type": "ListItem", "position": 53, "name": "寶劍三"},
            {"@type": "ListItem", "position": 54, "name": "寶劍四"},
            {"@type": "ListItem", "position": 55, "name": "寶劍五"},
            {"@type": "ListItem", "position": 56, "name": "寶劍六"},
            {"@type": "ListItem", "position": 57, "name": "寶劍七"},
            {"@type": "ListItem", "position": 58, "name": "寶劍八"},
            {"@type": "ListItem", "position": 59, "name": "寶劍九"},
            {"@type": "ListItem", "position": 60, "name": "寶劍十"},
            {"@type": "ListItem", "position": 61, "name": "寶劍侍者"},
            {"@type": "ListItem", "position": 62, "name": "寶劍騎士"},
            {"@type": "ListItem", "position": 63, "name": "寶劍王后"},
            {"@type": "ListItem", "position": 64, "name": "寶劍國王"},
            {"@type": "ListItem", "position": 65, "name": "錢幣一"},
            {"@type": "ListItem", "position": 66, "name": "錢幣二"},
            {"@type": "ListItem", "position": 67, "name": "錢幣三"},
            {"@type": "ListItem", "position": 68, "name": "錢幣四"},
            {"@type": "ListItem", "position": 69, "name": "錢幣五"},
            {"@type": "ListItem", "position": 70, "name": "錢幣六"},
            {"@type": "ListItem", "position": 71, "name": "錢幣七"},
            {"@type": "ListItem", "position": 72, "name": "錢幣八"},
            {"@type": "ListItem", "position": 73, "name": "錢幣九"},
            {"@type": "ListItem", "position": 74, "name": "錢幣十"},
            {"@type": "ListItem", "position": 75, "name": "錢幣侍者"},
            {"@type": "ListItem", "position": 76, "name": "錢幣騎士"},
            {"@type": "ListItem", "position": 77, "name": "錢幣王后"},
            {"@type": "ListItem", "position": 78, "name": "錢幣國王"}
          ]
        },
        {
          "@type": "FAQPage",
          "mainEntity": [
            {
              "@type": "Question",
              "name": "塔羅牌是什麼？",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "塔羅牌不僅是一種預測未來的工具，其更深層次的目的是為了解決問題、認識自我。它是一套由78張圖像豐富的卡牌組成的系統，透過圖像來幫助我們認識自我、覺察問題。使用塔羅牌應以解決生活問題、探索內心、尋找人生方向為核心目的。"
              }
            },
            {
              "@type": "Question",
              "name": "塔羅牌占卜如何運作？",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "塔羅牌的運作並非基於神秘力量，而是主要作為一種連結使用者「潛意識」的工具。當您專注於一個問題並抽出牌卡時，所選出的牌會與您個人的頻率產生共振，反映出您當下的內心狀態、課題與潛在的可能性。解牌的過程，就是將這些圖像語言轉化為對現實生活的洞見與指引。"
              }
            },
            {
              "@type": "Question",
              "name": "塔羅牌占卜準確嗎？",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "塔羅牌的準確性源於它反映了您當下的狀態與能量。它並非宿命論，而是揭示在「不做出改變」的情況下，最有可能發生的未來。如果您的心態或行動改變了，結果也會隨之改變。因此，塔羅牌的真正目的不是「算準」，而是引導人們看見可能性，從而創造自己想要的命運。"
              }
            },
            {
              "@type": "Question",
              "name": "大阿爾克那（大牌）和小阿爾克那（小牌）有什麼不同？",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "大阿爾克那（22張）代表宇宙性的宏觀能量、重大的生命課題或人生轉折點，其影響是深遠且長期的。小阿爾克那（56張）則更貼近日常生活，描繪具體的事件、情境與個人心態。小牌又分為四個牌組（權杖、聖杯、寶劍、錢幣），分別對應火、水、風、土四大元素，管理人生的不同面向。"
              }
            },
            {
              "@type": "Question",
              "name": "正位和逆位牌有什麼意義？",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "逆位並非單純的正位相反意思，而是正位能量的一種變化。它可能代表能量被壓抑、過度或不足、延遲，或是需要從不同的角度去理解。初學者可以先專注於正位牌義，待熟悉後再深入探索逆位所帶來的豐富解讀層次。"
              }
            },
            {
              "@type": "Question",
              "name": "我應該如何提問？",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "一個清晰的問題才能得到清晰的答案。建議提出開放式問題（例如「我該如何改善我的工作狀況？」）而非封閉式的是非題。對於初學者，可以將問題統一設定為「未來三個月的[某領域]發展如何？」，例如「未來三個月的工作發展如何？」來進行練習。"
              }
            }
          ]
        }
      ]
    }
    </script>
    
    <style>
        body {
            font-family: 'Noto Serif TC', serif;
            background-color: #111827; /* Darker blue-gray */
            color: #d1d5db; /* Lighter gray for text */
        }
        .active-spread {
            background-color: #facc15 !important; /* Yellow-400 */
            color: #111827 !important; /* Dark blue-gray text */
        }
        /* Style for details/summary accordion */
        details > summary {
            list-style: none;
            cursor: pointer;
            padding: 1.5rem;
            border-bottom: 1px solid #374151;
            font-size: 1.5rem;
            font-weight: 600;
            color: #fde047; /* Lighter Yellow */
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
        }
        details > summary::-webkit-details-marker {
            display: none;
        }
        details > summary:hover {
            background-color: #1f2937;
        }
        details > summary::after {
            content: '+';
            font-size: 2rem;
            color: #a5b4fc; /* Lighter Indigo */
            transition: transform 0.3s ease;
        }
        details[open] > summary::after {
            transform: rotate(45deg);
        }
        details .card-grid-container {
            padding: 1.5rem;
            background-color: rgba(17, 24, 39, 0.7);
        }
        .card-image {
            aspect-ratio: 2 / 3.5;
            width: 100%;
            height: auto;
            object-fit: cover;
            border-radius: 8px;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-300">

    <!-- Header Section -->
    <header class="text-center py-12 md:py-20 px-4" style="background: radial-gradient(circle, #1f2937 0%, #111827 100%);">
        <h1 class="text-4xl md:text-6xl font-bold text-yellow-300 tracking-wider">線上塔羅神諭</h1>
        <p class="text-lg md:text-xl mt-4 text-indigo-300">探索自我・洞見未來</p>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 max-w-7xl">

        <!-- Introduction Section -->
        <section id="introduction" class="mb-16 bg-gray-800 bg-opacity-50 p-8 rounded-2xl shadow-lg">
            <h2 class="text-3xl font-bold text-yellow-300 mb-6 border-b-2 border-yellow-300 border-opacity-50 pb-3">塔羅的智慧之旅</h2>
            <div class="space-y-6 text-base md:text-lg leading-relaxed text-gray-200">
                <p>塔羅牌不僅僅是一種預測未來的工具，其更深層次的目的是為了解決問題、認識自我。它是一套透過圖像來認識自我、覺察問題的牌卡。因此，使用塔羅牌應以解決生活問題、探索內心、尋找人生方向為核心目的，而非僅僅追求預測的準確度。學習的過程本身，就是透過牌卡來體驗生命、讓心靈變得更好。</p>
                <p>本網站提供免費的線上占卜，幫助您在迷惘時找到方向，在困頓中獲得啟示。請靜下心來，專注於您的問題，讓塔羅牌引領您看見內在的智慧。</p>
            </div>
        </section>

        <!-- Online Reading Section -->
        <section id="reading-section" class="mb-16 bg-gray-800 bg-opacity-50 p-8 rounded-2xl shadow-lg">
            <h2 class="text-3xl font-bold text-yellow-300 mb-8 text-center">線上塔羅占卜</h2>
            
            <!-- Step 1: Spread Selection -->
            <div class="text-center mb-8">
                <p class="text-lg text-indigo-300 mb-4">第一步：選擇您的牌陣</p>
                <div class="flex justify-center space-x-4">
                    <button id="spread-cause-effect" class="px-6 py-3 bg-gray-700 text-white font-semibold rounded-lg shadow-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-75 transition duration-300">因果牌陣 (2張)</button>
                    <button id="spread-timeline" class="px-6 py-3 bg-gray-700 text-white font-semibold rounded-lg shadow-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-75 transition duration-300">時間之流牌陣 (3張)</button>
                </div>
            </div>
             <p id="spread-description" class="text-center text-indigo-200 mb-8 h-12"></p>
            
            <!-- Step 2: Draw Button -->
            <div class="text-center mb-8">
                 <p class="text-lg text-indigo-300 mb-4">第二步：專注默念問題後，按下抽牌</p>
                <button id="draw-cards-btn" class="px-8 py-4 bg-yellow-500 text-gray-900 font-bold text-lg rounded-lg shadow-xl hover:bg-yellow-400 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-opacity-75 transition-transform transform hover:scale-105 duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-600" disabled>請先選擇牌陣</button>
            </div>

            <!-- Reading Result -->
            <div id="reading-result" class="hidden">
                <h3 id="result-title" class="text-2xl font-bold text-center mb-6 text-yellow-300"></h3>
                <div id="drawn-cards" class="flex justify-center items-start gap-4 md:gap-8 flex-wrap mb-8">
                    <!-- Cards will be injected here -->
                </div>
                
                <div id="analysis-result" class="bg-gray-900 bg-opacity-40 p-6 rounded-lg">
                     <!-- Analysis will be injected here -->
                </div>

                <!-- EmailJS Form -->
                <div id="email-form-container" class="mt-12 bg-gray-800 bg-opacity-70 p-8 rounded-2xl">
                    <h4 class="text-2xl font-bold text-center mb-4 text-yellow-300">寄送詳細分析報告</h4>
                    <p class="text-center text-indigo-300 mb-6 max-w-2xl mx-auto">想獲得更深入的個人化牌義詳解嗎？輸入您的電子信箱，我們將會把完整的分析報告寄送給您。</p>
                    <div class="flex flex-col md:flex-row max-w-lg mx-auto gap-4">
                        <input type="email" id="email-input" placeholder="請輸入您的電子信箱" class="flex-grow px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400 text-white">
                        <button id="send-email-btn" class="px-6 py-3 bg-indigo-500 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-600 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-opacity-75 transition duration-300">寄送報告</button>
                    </div>
                     <p class="text-xs text-gray-500 text-center mt-4">🔒 隱私聲明：您的資料僅用於寄送本次報告，系統不會保存你的資料與占卜結果。寄送完成後即時處理。若想再次取得報告，請重新占卜。</p>
                    <p id="email-status" class="text-center mt-4 h-6"></p>
                </div>
            </div>
        </section>

        <!-- Card Meaning Section -->
        <section id="card-meaning-section" class="bg-gray-800 bg-opacity-50 p-8 rounded-2xl shadow-lg">
            <h2 class="text-3xl font-bold text-yellow-300 mb-8 text-center">78張塔羅牌義詳解</h2>

            <!-- Major Arcana -->
            <details>
                <summary>大阿爾克那 (Major Arcana)</summary>
                <div class="card-grid-container grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4" id="major-arcana-grid"></div>
            </details>

            <!-- Wands -->
            <details>
                <summary>權杖 (Wands)</summary>
                <div class="card-grid-container grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4" id="wands-grid"></div>
            </details>

            <!-- Cups -->
            <details>
                <summary>聖杯 (Cups)</summary>
                <div class="card-grid-container grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4" id="cups-grid"></div>
            </details>
            
            <!-- Swords -->
            <details>
                <summary>寶劍 (Swords)</summary>
                <div class="card-grid-container grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4" id="swords-grid"></div>
            </details>

            <!-- Pentacles -->
            <details>
                <summary>錢幣 (Pentacles)</summary>
                <div class="card-grid-container grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-4" id="pentacles-grid"></div>
            </details>
            
        </section>
        
        <!-- FAQ Section -->
        <section id="faq-section" class="mt-16 bg-gray-800 bg-opacity-50 p-8 rounded-2xl shadow-lg">
            <h2 class="text-3xl font-bold text-yellow-300 mb-8 text-center">塔羅牌常見問題 (FAQ)</h2>
            <div class="space-y-4">
                <details>
                    <summary class="text-xl text-indigo-300 hover:text-yellow-300">塔羅牌是什麼？</summary>
                    <div class="pt-2 pb-4 px-4 text-gray-400">
                        <p>塔羅牌不僅是一種預測未來的工具，其更深層次的目的是為了解決問題、認識自我。它是一套由78張圖像豐富的卡牌組成的系統，透過圖像來幫助我們認識自我、覺察問題。使用塔羅牌應以解決生活問題、探索內心、尋找人生方向為核心目的。</p>
                    </div>
                </details>
                <details>
                    <summary class="text-xl text-indigo-300 hover:text-yellow-300">塔羅牌占卜如何運作？</summary>
                    <div class="pt-2 pb-4 px-4 text-gray-400">
                        <p>塔羅牌的運作並非基於神秘力量，而是主要作為一種連結使用者「潛意識」的工具。當您專注於一個問題並抽出牌卡時，所選出的牌會與您個人的頻率產生共振，反映出您當下的內心狀態、課題與潛在的可能性。解牌的過程，就是將這些圖像語言轉化為對現實生活的洞見與指引。</p>
                    </div>
                </details>
                <details>
                    <summary class="text-xl text-indigo-300 hover:text-yellow-300">塔羅牌占卜準確嗎？</summary>
                    <div class="pt-2 pb-4 px-4 text-gray-400">
                        <p>塔羅牌的準確性源於它反映了您當下的狀態與能量。它並非宿命論，而是揭示在「不做出改變」的情況下，最有可能發生的未來。如果您的心態或行動改變了，結果也會隨之改變。因此，塔羅牌的真正目的不是「算準」，而是引導人們看見可能性，從而創造自己想要的命運。</p>
                    </div>
                </details>
                <details>
                    <summary class="text-xl text-indigo-300 hover:text-yellow-300">大阿爾克那（大牌）和小阿爾克那（小牌）有什麼不同？</summary>
                    <div class="pt-2 pb-4 px-4 text-gray-400">
                        <p>大阿爾克那（22張）代表宇宙性的宏觀能量、重大的生命課題或人生轉折點，其影響是深遠且長期的。小阿爾克那（56張）則更貼近日常生活，描繪具體的事件、情境與個人心態。小牌又分為四個牌組（權杖、聖杯、寶劍、錢幣），分別對應火、水、風、土四大元素，管理人生的不同面向。</p>
                    </div>
                </details>
                 <details>
                    <summary class="text-xl text-indigo-300 hover:text-yellow-300">正位和逆位牌有什麼意義？</summary>
                    <div class="pt-2 pb-4 px-4 text-gray-400">
                        <p>逆位並非單純的正位相反意思，而是正位能量的一種變化。它可能代表能量被壓抑、過度或不足、延遲，或是需要從不同的角度去理解。初學者可以先專注於正位牌義，待熟悉後再深入探索逆位所帶來的豐富解讀層次。</p>
                    </div>
                </details>
                 <details>
                    <summary class="text-xl text-indigo-300 hover:text-yellow-300">我應該如何提問？</summary>
                    <div class="pt-2 pb-4 px-4 text-gray-400">
                        <p>一個清晰的問題才能得到清晰的答案。建議提出開放式問題（例如「我該如何改善我的工作狀況？」）而非封閉式的是非題。對於初學者，可以將問題統一設定為「未來三個月的[某領域]發展如何？」，例如「未來三個月的工作發展如何？」來進行練習。</p>
                    </div>
                </details>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="text-center py-8 mt-12 border-t border-gray-700">
        <p class="text-gray-500">&copy; 2025 線上塔羅神諭. All Rights Reserved <a href="https://www.wedopr.com" target="_blank" rel="noopener noreferrer" class="text-indigo-400 hover:text-yellow-300">@WEDO</a></p>
    </footer>


    <!-- Modal for Card Details -->
    <div id="card-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 z-50 flex justify-center items-center p-4">
        <div class="bg-gray-800 text-gray-200 rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto relative">
            <button id="close-modal" class="absolute top-4 right-4 text-gray-400 hover:text-white text-3xl">&times;</button>
            <div id="modal-content" class="p-6 md:p-8">
                <!-- Card details will be injected here -->
            </div>
        </div>
    </div>

    <!-- JavaScript Logic -->
    <script>
        window.addEventListener('pageshow', (event) => {
          if (event.persisted) {
            document.querySelectorAll('details').forEach(detail => {
              detail.removeAttribute('open');
            });
          }
        });

        const allCards = [
            // ... Major Arcana
            { name: "愚人", type: "大阿爾克那", img: "https://i.urusai.cc/myiOW.jpeg" },
            { name: "魔術師", type: "大阿爾克那", img: "https://i.urusai.cc/V3gw6.jpeg" },
            { name: "女祭司", type: "大阿爾克那", img: "https://i.urusai.cc/VNb65.jpeg" },
            { name: "皇后", type: "大阿爾克那", img: "https://i.urusai.cc/wVEX3.jpeg" },
            { name: "皇帝", type: "大阿爾克那", img: "https://i.urusai.cc/xkvjL.jpeg" },
            { name: "教宗", type: "大阿爾克那", img: "https://i.urusai.cc/z233n.jpeg" },
            { name: "戀人", type: "大阿爾克那", img: "https://i.urusai.cc/wf8po.jpeg" },
            { name: "戰車", type: "大阿爾克那", img: "https://i.urusai.cc/dx9Sn.jpeg" },
            { name: "力量", type: "大阿爾克那", img: "https://i.urusai.cc/bnHGo.jpeg" },
            { name: "隱士", type: "大阿爾克那", img: "https://i.urusai.cc/GOq3k.jpeg" },
            { name: "命運之輪", type: "大阿爾克那", img: "https://i.urusai.cc/zkpMV.jpeg" },
            { name: "正義", type: "大阿爾克那", img: "https://i.urusai.cc/E2Wyi.jpeg" },
            { name: "吊人", type: "大阿爾克那", img: "https://i.urusai.cc/pkaQf.jpeg" },
            { name: "死神", type: "大阿爾克那", img: "https://i.urusai.cc/SUe7O.jpeg" },
            { name: "節制", type: "大阿爾克那", img: "https://i.urusai.cc/TN1aj.jpeg" },
            { name: "惡魔", type: "大阿爾克那", img: "https://i.urusai.cc/hGBJS.jpeg" },
            { name: "塔", type: "大阿爾克那", img: "https://i.urusai.cc/6yuLx.jpeg" },
            { name: "星星", type: "大阿爾克那", img: "https://i.urusai.cc/el0N1.jpeg" },
            { name: "月亮", type: "大阿爾克那", img: "https://i.urusai.cc/4TPBJ.jpeg" },
            { name: "太陽", type: "大阿爾克那", img: "https://i.urusai.cc/yVqvp.jpeg" },
            { name: "審判", type: "大阿爾克那", img: "https://i.urusai.cc/32YH1.jpeg" },
            { name: "世界", type: "大阿爾克那", img: "https://i.urusai.cc/UKTLH.jpeg" },
            // ... Wands
            { name: "權杖一", type: "權杖", img: "https://i.urusai.cc/gCsOt.jpeg" },
            { name: "權杖二", type: "權杖", img: "https://i.urusai.cc/4X54O.jpeg" },
            { name: "權杖三", type: "權杖", img: "https://i.urusai.cc/Qv7wY.jpeg" },
            { name: "權杖四", type: "權杖", img: "https://i.urusai.cc/P9vMq.jpeg" },
            { name: "權杖五", type: "權杖", img: "https://i.urusai.cc/Hj53f.jpeg" },
            { name: "權杖六", type: "權杖", img: "https://i.urusai.cc/z1BJd.jpeg" },
            { name: "權杖七", type: "權杖", img: "https://i.urusai.cc/ri4bD.jpeg" },
            { name: "權杖八", type: "權杖", img: "https://i.urusai.cc/M5Flf.jpeg" },
            { name: "權杖九", type: "權杖", img: "https://i.urusai.cc/H2AjL.jpeg" },
            { name: "權杖十", type: "權杖", img: "https://i.urusai.cc/P1S56.jpeg" },
            { name: "權杖侍者", type: "權杖", img: "https://i.urusai.cc/12HwY.jpeg" },
            { name: "權杖騎士", type: "權杖", img: "https://i.urusai.cc/HUSWA.jpeg" },
            { name: "權杖王后", type: "權杖", img: "https://i.urusai.cc/LlOKb.jpeg" },
            { name: "權杖國王", type: "權杖", img: "https://i.urusai.cc/XkqoJ.jpeg" },
            // ... Cups
            { name: "聖杯一", type: "聖杯", img: "https://i.urusai.cc/BP986.jpeg" },
            { name: "聖杯二", type: "聖杯", img: "https://i.urusai.cc/J7Yqv.jpeg" },
            { name: "聖杯三", type: "聖杯", img: "https://i.urusai.cc/441CD.jpeg" },
            { name: "聖杯四", type: "聖杯", img: "https://i.urusai.cc/uUlZh.jpeg" },
            { name: "聖杯五", type: "聖杯", img: "https://i.urusai.cc/bC2fO.jpeg" },
            { name: "聖杯六", type: "聖杯", img: "https://i.urusai.cc/t2LbD.jpeg" },
            { name: "聖杯七", type: "聖杯", img: "https://i.urusai.cc/msjER.jpeg" },
            { name: "聖杯八", type: "聖杯", img: "https://i.urusai.cc/xh6MN.jpeg" },
            { name: "聖杯九", type: "聖杯", img: "https://i.urusai.cc/iQyxf.jpeg" },
            { name: "聖杯十", type: "聖杯", img: "https://i.urusai.cc/uXV7T.jpeg" },
            { name: "聖杯侍者", type: "聖杯", img: "https://i.urusai.cc/JFe5O.jpeg" },
            { name: "聖杯騎士", type: "聖杯", img: "https://i.urusai.cc/9O7fF.jpeg" },
            { name: "聖杯王后", type: "聖杯", img: "https://i.urusai.cc/KbNTo.jpeg" },
            { name: "聖杯國王", type: "聖杯", img: "https://i.urusai.cc/qM6g9.jpeg" },
            // ... Swords
            { name: "寶劍一", type: "寶劍", img: "https://i.urusai.cc/MnMh2.jpeg" },
            { name: "寶劍二", type: "寶劍", img: "https://i.urusai.cc/YaZ4y.jpeg" },
            { name: "寶劍三", type: "寶劍", img: "https://i.urusai.cc/jdDqb.jpeg" },
            { name: "寶劍四", type: "寶劍", img: "https://i.urusai.cc/dqzqG.jpeg" },
            { name: "寶劍五", type: "寶劍", img: "https://i.urusai.cc/fEyOm.jpeg" },
            { name: "寶劍六", type: "寶劍", img: "https://i.urusai.cc/cakNp.jpeg" },
            { name: "寶劍七", type: "寶劍", img: "https://i.urusai.cc/boWZf.jpeg" },
            { name: "寶劍八", type: "寶劍", img: "https://i.urusai.cc/mQxzN.jpeg" },
            { name: "寶劍九", type: "寶劍", img: "https://i.urusai.cc/198GY.jpeg" },
            { name: "寶劍十", type: "寶劍", img: "https://i.urusai.cc/TM7nJ.jpeg" },
            { name: "寶劍侍者", type: "寶劍", img: "https://i.urusai.cc/tFi1n.jpeg" },
            { name: "寶劍騎士", type: "寶劍", img: "https://i.urusai.cc/0zwp3.jpeg" },
            { name: "寶劍王后", type: "寶劍", img: "https://i.urusai.cc/fwjWB.jpeg" },
            { name: "寶劍國王", type: "寶劍", img: "https://i.urusai.cc/rWTFf.jpeg" },
            // ... Pentacles
            { name: "錢幣一", type: "錢幣", img: "https://i.urusai.cc/yPTi0.jpeg" },
            { name: "錢幣二", type: "錢幣", img: "https://i.urusai.cc/3rS9e.jpeg" },
            { name: "錢幣三", type: "錢幣", img: "https://i.urusai.cc/pwnsC.jpeg" },
            { name: "錢幣四", type: "錢幣", img: "https://i.urusai.cc/3lLGp.jpeg" },
            { name: "錢幣五", type: "錢幣", img: "https://i.urusai.cc/KLMdF.jpeg" },
            { name: "錢幣六", type: "錢幣", img: "https://i.urusai.cc/zJf26.jpeg" },
            { name: "錢幣七", type: "錢幣", img: "https://i.urusai.cc/yuTan.jpeg" },
            { name: "錢幣八", type: "錢幣", img: "https://i.urusai.cc/rEiV6.jpeg" },
            { name: "錢幣九", type: "錢幣", img: "https://i.urusai.cc/Q67US.jpeg" },
            { name: "錢幣十", type: "錢幣", img: "https://i.urusai.cc/WWGb3.jpeg" },
            { name: "錢幣侍者", type: "錢幣", img: "https://i.urusai.cc/3PAFD.jpeg" },
            { name: "錢幣騎士", type: "錢幣", img: "https://i.urusai.cc/CLKad.jpeg" },
            { name: "錢幣王后", type: "錢幣", img: "https://i.urusai.cc/JEssn.jpeg" },
            { name: "錢幣國王", type: "錢幣", img: "https://i.urusai.cc/WLUt7.jpeg" },
        ];
        
        const cardKeywords = {
            "愚人": { upright: "開始、冒險、天真、潛力、無限可能", reversed: "魯莽、天真、不明智的決定、猶豫不決" },
            "魔術師": { upright: "創造力、溝通、技能、萬事俱備、主動", reversed: "欺騙、濫用才能、缺乏創意、精力錯置" },
            "女祭司": { upright: "直覺、智慧、神秘、靜默、潛意識", reversed: "秘密、膚淺、忽視直覺、情緒化" },
            "皇后": { upright: "豐收、母愛、創造、自然、享樂", reversed: "不孕、停滯、依賴、失職的母親、過度放縱" },
            "皇帝": { upright: "權力、秩序、統治、父親、穩定", reversed: "暴君、濫用權力、不成熟、缺乏自律" },
            "教宗": { upright: "傳統、宗教、教育、道德、貴人相助", reversed: "打破傳統、思想僵化、誤導、虛偽" },
            "戀人": { upright: "愛情、選擇、結合、人際關係、價值觀", reversed: "錯誤的選擇、關係失和、分離、三角關係" },
            "戰車": { upright: "勝利、意志力、自律、競爭、前進", reversed: "失敗、失控、魯莽、衝突、方向錯誤" },
            "力量": { upright: "勇氣、信心、耐心、以柔克剛、內在力量", reversed: "軟弱、恐懼、缺乏自信、濫用力量" },
            "隱士": { upright: "內省、孤獨、指引、謹慎、智慧", reversed: "孤僻、固執、粗心、拒絕忠告" },
            "命運之輪": { upright: "命運、轉變、契機、幸運、循環", reversed: "厄運、抗拒改變、停滯、意外的打擊" },
            "正義": { upright: "公正、平衡、法律、決定、誠實", reversed: "不公、偏見、法律問題、錯誤的決定" },
            "吊人": { upright: "犧牲、等待、換位思考、以退為進、順應", reversed: "無謂的犧牲、掙扎、鑽牛角尖、停滯不前" },
            "死神": { upright: "結束、轉變、新生、放下、過渡期", reversed: "抗拒改變、沉溺過去、停滯、恐懼結束" },
            "節制": { upright: "中庸、調和、溝通、適應、耐心", reversed: "失衡、極端、溝通不良、缺乏耐心" },
            "惡魔": { upright: "慾望、束縛、沉迷、物質主義、誘惑", reversed: "掙脫束縛、自由、思想開放、認清真相" },
            "塔": { upright: "遽變、災難、破壞、覺醒、天啟", reversed: "困境、逃避改變、延遲的災難、內在的混亂" },
            "星星": { upright: "希望、信心、寧靜、療癒、靈感", reversed: "絕望、沮喪、失信、迷失方向" },
            "月亮": { upright: "不安、恐懼、幻象、潛意識、秘密", reversed: "真相大白、解除困惑、克服恐懼、謊言被揭穿" },
            "太陽": { upright: "成功、快樂、自由、活力、清晰", reversed: "短暫的成功、虛假的快樂、缺乏熱情、悲觀" },
            "審判": { upright: "復活、召喚、決定、解放、業力", reversed: "自我批判、逃避決定、錯失良機、內疚" },
            "世界": { upright: "完成、圓滿、整合、成就、旅行", reversed: "未完成、停滯、缺乏整合、原地踏步" },
            "權杖一": { upright: "新行動、創造、機會、靈感、潛力", reversed: "延遲、缺乏動力、錯失機會、計畫失敗" },
            "權杖二": { upright: "計畫、決定、權力、展望未來、選擇", reversed: "猶豫不決、計畫不周、失去方向、恐懼未知" },
            "權杖三": { upright: "領導、遠見、合作、探索、初步成功", reversed: "缺乏遠見、合作破裂、延遲、目光短淺" },
            "權杖四": { upright: "慶祝、和諧、穩定、家庭、避風港", reversed: "不穩定、家庭失和、關係緊張、缺乏歸屬感" },
            "權杖五": { upright: "競爭、衝突、挑戰、不同意見、混亂", reversed: "避免衝突、尋求和解、內在鬥爭、疲憊" },
            "權杖六": { upright: "勝利、成功、認可、自信、好消息", reversed: "失敗、驕傲自大、缺乏認可、壞消息" },
            "權杖七": { upright: "防禦、挑戰、勇氣、堅持立場、有利位置", reversed: "投降、不知所措、失去優勢、疲於應付" },
            "權杖八": { upright: "迅速、行動、旅行、好消息、進展", reversed: "延遲、阻礙、猶豫、壞消息" },
            "權杖九": { upright: "警覺、防禦、經驗、等待、堅韌", reversed: "精疲力竭、放棄防守、偏執、舊傷復發" },
            "權杖十": { upright: "負擔、責任、壓力、過勞、堅持", reversed: "放下負擔、崩潰、逃避責任、委派任務" },
            "權杖侍者": { upright: "探索、好奇、新消息、學習、熱情", reversed: "壞消息、猶豫不決、缺乏方向、不成熟" },
            "權杖騎士": { upright: "行動力、熱情、衝動、冒險、旅行", reversed: "魯莽、延遲、挫折、精力分散" },
            "權杖王后": { upright: "自信、熱情、領導力、有魅力、獨立", reversed: "嫉妒、專橫、缺乏自信、情緒化" },
            "權杖國王": { upright: "領導者、有遠見、創造力、權威、果斷", reversed: "暴君、衝動、決策失誤、缺乏遠見" },
            "聖杯一": { upright: "新感情、愛、喜悅、感受、直覺", reversed: "情感壓抑、失落、關係空虛、錯失愛的機會" },
            "聖杯二": { upright: "結合、伴侶、合作、友誼、和諧", reversed: "分手、失和、關係不對等、合作破裂" },
            "聖杯三": { upright: "慶祝、友誼、團體、歡樂、合作", reversed: "過度放縱、團體失和、流言蜚語、孤立" },
            "聖杯四": { upright: "不滿、冷漠、內省、錯失機會、觀望", reversed: "抓住新機會、走出低潮、重新燃起熱情" },
            "聖杯五": { upright: "失落、悲傷、專注於失去、遺憾", reversed: "走出悲傷、原諒、接受、看到希望" },
            "聖杯六": { upright: "懷舊、童年、回憶、饋贈、純真", reversed: "沉溺過去、不願成長、不愉快的童年" },
            "聖杯七": { upright: "幻想、選擇、白日夢、不切實際", reversed: "認清現實、做出決定、目標明確、避免誘惑" },
            "聖杯八": { upright: "拋棄、尋找、不滿足、轉身離開", reversed: "猶豫不決、害怕改變、困在原地、無力離開" },
            "聖杯九": { upright: "美夢成真、滿足、享樂、得意", reversed: "不滿足、貪婪、自滿、虛假的快樂" },
            "聖杯十": { upright: "家庭美滿、幸福、和諧、情感圓滿", reversed: "家庭失和、關係破裂、期望落空" },
            "聖杯侍者": { upright: "情感的訊息、直覺、好奇、新的可能性", reversed: "情感不成熟、情緒化、逃避現實" },
            "聖杯騎士": { upright: "浪漫、魅力、提議、溫柔、理想主義", reversed: "善變、欺騙、不切實際、情感操控" },
            "聖杯王后": { upright: "同理心、關懷、直覺、母性、溫柔", reversed: "情緒化、依賴、過度敏感、情感勒索" },
            "聖杯國王": { upright: "情感成熟、寬容、外交手腕、冷靜", reversed: "情緒不穩、情感操控、冷漠、壓抑" },
            "寶劍一": { upright: "新挑戰、清晰、理智、決心、突破", reversed: "混亂、決策失誤、缺乏清晰度、濫用權力" },
            "寶劍二": { upright: "對立、僵局、逃避、選擇困難", reversed: "做出決定、打破僵局、謊言被揭穿" },
            "寶劍三": { upright: "悲傷、心碎、失落、痛苦、分離", reversed: "走出傷痛、原諒、釋懷、恢復" },
            "寶劍四": { upright: "休息、沉思、準備、平靜、休養", reversed: "停滯、精疲力竭、被迫行動、焦慮" },
            "寶劍五": { upright: "得不償失的勝利、自私、屈辱、衝突", reversed: "和解、放下怨恨、承認錯誤、避免衝突" },
            "寶劍六": { upright: "過渡、療傷、旅行、放下過去", reversed: "停滯不前、無法釋懷、旅途不順" },
            "寶劍七": { upright: "欺騙、策略、逃避、不誠實", reversed: "被揭穿、誠實、面對現實、良心發現" },
            "寶劍八": { upright: "自我設限、困惑、無助、受害者心態", reversed: "掙脫束縛、找到出路、看清真相" },
            "寶劍九": { upright: "焦慮、恐懼、噩夢、絕望、罪惡感", reversed: "走出陰霾、尋求幫助、克服恐懼" },
            "寶劍十": { upright: "結束、失敗、痛苦的終結、黎明前的黑暗", reversed: "無法解脫、持續的痛苦、舊事重演" },
            "寶劍侍者": { upright: "好奇、學習、新消息、警覺、溝通", reversed: "流言蜚語、缺乏規劃、說謊、壞消息" },
            "寶劍騎士": { upright: "果斷、直接、聰明、行動迅速、有野心", reversed: "魯莽、具攻擊性、言辭傷人、缺乏遠見" },
            "寶劍王后": { upright: "理智、獨立、誠實、清晰、有洞察力", reversed: "冷酷、刻薄、偏見、過於批判" },
            "寶劍國王": { upright: "權威、邏輯、智慧、專業、公正", reversed: "專制、濫用權力、不擇手段、冷酷無情" },
            "錢幣一": { upright: "新機會、務實、豐盛、顯化、穩定", reversed: "錯失良機、財務損失、計畫不周" },
            "錢幣二": { upright: "平衡、適應、多工、彈性、財務管理", reversed: "失衡、財務困難、決策失誤、分身乏術" },
            "錢幣三": { upright: "團隊合作、技能、學習、品質、初步成果", reversed: "合作不順、缺乏技能、品質低劣" },
            "錢幣四": { upright: "掌控、穩定、安全感、節儉、守財", reversed: "貪婪、吝嗇、害怕改變、財務損失" },
            "錢幣五": { upright: "貧困、逆境、孤立、財務困難、尋求幫助", reversed: "走出困境、復甦、找到援助" },
            "錢幣六": { upright: "慷慨、分享、施與受、財務援助", reversed: "債務、吝嗇、不平等的關係、濫用善心" },
            "錢幣七": { upright: "耐心、評估、等待收穫、長期投資", reversed: "不耐煩、投資失敗、半途而廢" },
            "錢幣八": { upright: "專注、技能、勤奮、精益求精", reversed: "缺乏野心、工作乏味、重複勞動" },
            "錢幣九": { upright: "獨立、豐收、自信、享受成果", reversed: "依賴、財務損失、空虛、過度揮霍" },
            "錢幣十": { upright: "財富、傳承、家庭、穩定、長遠成功", reversed: "財務糾紛、家庭問題、失去穩定" },
            "錢幣侍者": { upright: "學習、新機會、務實、專注", reversed: "缺乏規劃、錯失良機、懶惰、壞消息" },
            "錢幣騎士": { upright: "勤奮、可靠、耐心、按部就班", reversed: "停滯、懶惰、固執、缺乏動力" },
            "錢幣王后": { upright: "務實、照顧、慷慨、穩定、享受生活", reversed: "過度物質、缺乏安全感、嫉妒、吝嗇" },
            "錢幣國王": { upright: "成功、富裕、可靠、企業家、穩定", reversed: "貪婪、腐敗、固執、財務失利" },
        };

        // Grouped card meanings with detailed explanations
        const cardMeanings = {
            "愚人": {
                concept: "<b>核心概念：大阿爾克那 0・愚者之旅的起點</b><br>愚人代表旅程的開端、純真與無限的可能性。他的編號是0，象徵著一個全新的循環，充滿了未知與潛力。在占卜中，他象徵著一次大膽的躍進，提醒我們要憑直覺行事，勇敢地踏出第一步。",
                upright: "<b>正位：開始、冒險、天真、潛力、無限可能</b><br>當愚人正位時，代表一個充滿潛力的新開始。這是一個鼓勵你放下恐懼、相信直覺、勇敢踏上新旅程的時刻。你可能面臨一個全新的機會，或是決定要以一種全新的、不受束縛的方式生活。這張牌鼓勵你擁抱未知，享受過程中的自由與驚喜。",
                reversed: "<b>逆位：魯莽、天真、不明智的決定、猶豫不決</b><br>逆位的愚人，其天真可能轉為愚蠢，大膽變為魯莽。你可能做出了不明智的決定，或是因為害怕而猶豫不決，錯失了良機。這張牌提醒你要更加謹慎，在行動前多加思考，避免因一時衝動而陷入困境。同時，也可能暗示你過於在意他人眼光，而不敢追尋自己真正的渴望。"
            },
            "魔術師": {
                concept: "<b>核心概念：大阿爾克那 1・資源的整合與創造</b><br>魔術師是所有數字的開端，代表將想法化為現實的強大創造力。他掌握了四大元素（權杖、聖杯、寶劍、錢幣），象徵著他擁有實現目標所需的一切資源與技能。他提醒我們，只要專注意志，就能將潛力轉化為成就。",
                upright: "<b>正位：創造力、溝通、技能、萬事俱備、主動</b><br>正位的魔術師是一張充滿力量與自信的牌。它表示你現在擁有所需的技能、資源與創造力來達成目標。這是一個採取主動、開始新計畫的絕佳時機。你的溝通能力會很強，能夠清晰地表達自己的想法，並說服他人。相信自己的能力，你就能創造奇蹟。",
                reversed: "<b>逆位：欺騙、濫用才能、缺乏創意、精力錯置</b><br>逆位的魔術師可能暗示著才能的濫用或誤用。你可能將聰明才智用在了錯誤的地方，甚至進行欺騙。也可能表示你缺乏自信、精力不集中，導致計畫停滯不前。這張牌提醒你要誠實面對自己，檢視自己的動機，確保將精力用在有建設性的地方。"
            },
            // ... (The rest of the card meanings are dynamically generated or follow a similar detailed structure)
        };

        let currentSpread = null;
        let drawnCardsData = [];

        document.addEventListener('DOMContentLoaded', () => {
            (function(){
                emailjs.init("nYyZS-Q-jokmGLMfM");
            })();

            const majorArcanaGrid = document.getElementById('major-arcana-grid');
            const wandsGrid = document.getElementById('wands-grid');
            const cupsGrid = document.getElementById('cups-grid');
            const swordsGrid = document.getElementById('swords-grid');
            const pentaclesGrid = document.getElementById('pentacles-grid');
            
            const grids = {
                '大阿爾克那': majorArcanaGrid,
                '權杖': wandsGrid,
                '聖杯': cupsGrid,
                '寶劍': swordsGrid,
                '錢幣': pentaclesGrid
            };

            function createCardElement(card) {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'cursor-pointer transform hover:scale-105 transition-transform duration-300';
                cardDiv.innerHTML = `<img src="${card.img}" alt="${card.name}" class="card-image shadow-lg hover:shadow-yellow-400/30">`;
                cardDiv.addEventListener('click', () => showCardDetails(card.name));
                return cardDiv;
            }

            allCards.forEach(card => {
                if (grids[card.type]) {
                    grids[card.type].appendChild(createCardElement(card));
                }
            });

            const spreadCauseEffectBtn = document.getElementById('spread-cause-effect');
            const spreadTimelineBtn = document.getElementById('spread-timeline');
            const drawCardsBtn = document.getElementById('draw-cards-btn');
            const spreadDescription = document.getElementById('spread-description');
            
            function selectSpread(spreadType, btnElement) {
                currentSpread = spreadType;
                drawCardsBtn.disabled = false;
                
                // Reset both buttons
                spreadCauseEffectBtn.classList.remove('active-spread');
                spreadTimelineBtn.classList.remove('active-spread');
                spreadCauseEffectBtn.classList.add('bg-gray-700');
                spreadTimelineBtn.classList.add('bg-gray-700');

                // Activate the selected one
                btnElement.classList.add('active-spread');
                btnElement.classList.remove('bg-gray-700');

                if (spreadType === 'cause-effect') {
                    spreadDescription.textContent = '「因果牌陣」將抽出兩張牌，分別代表事件的原因與可能的結果。';
                    drawCardsBtn.textContent = '抽取因果牌陣';
                } else {
                    spreadDescription.textContent = '「時間之流牌陣」將抽出三張牌，分別代表事件的過去、現在與未來。';
                    drawCardsBtn.textContent = '抽取時間之流牌陣';
                }
            }

            spreadCauseEffectBtn.addEventListener('click', (e) => selectSpread('cause-effect', e.currentTarget));
            spreadTimelineBtn.addEventListener('click', (e) => selectSpread('timeline', e.currentTarget));
            drawCardsBtn.addEventListener('click', drawCards);

            document.getElementById('send-email-btn').addEventListener('click', sendEmail);

            // Modal functionality
            const modal = document.getElementById('card-modal');
            const closeModalBtn = document.getElementById('close-modal');
            closeModalBtn.addEventListener('click', () => modal.classList.add('hidden'));
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.add('hidden');
                }
            });
        });

        function getFullCardData(cardName) {
             const baseInfo = allCards.find(c => c.name === cardName);
             const keywords = cardKeywords[cardName] || { upright: "", reversed: "" };
             const meanings = cardMeanings[cardName] || {
                concept: `<b>核心概念：${baseInfo.type}</b><br>此牌組代表著四大元素中的一種，反映了我們日常生活的具體事件、情境與心態。`,
                upright: `<b>正位：${keywords.upright}</b><br>正位牌通常代表該牌能量的順暢、積極展現。`,
                reversed: `<b>逆位：${keywords.reversed}</b><br>逆位牌則可能暗示能量的轉變，例如被壓抑、過度或不足、延遲等，需要從不同角度去理解。`
            };
            return { ...baseInfo, ...keywords, ...meanings };
        }

        function showCardDetails(cardName) {
            const card = getFullCardData(cardName);
            const modalContent = document.getElementById('modal-content');
            modalContent.innerHTML = `
                <div class="md:flex md:gap-8">
                    <div class="md:w-1/3 text-center mb-6 md:mb-0">
                        <img src="${card.img}" alt="${card.name}" class="w-full max-w-[200px] mx-auto rounded-lg shadow-xl">
                        <h2 class="text-3xl font-bold mt-4 text-yellow-300">${card.name}</h2>
                        <p class="text-indigo-300">${card.type}</p>
                    </div>
                    <div class="md:w-2/3 space-y-4">
                        <div class="bg-gray-700 p-4 rounded-lg">
                            <p class="text-gray-300 leading-relaxed">${card.concept}</p>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-yellow-300 mb-2">正位牌義：${card.upright}</h3>
                            <p class="text-gray-300 leading-relaxed">${card.upright_full || '詳細說明待補充。'}</p>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold text-yellow-300 mb-2">逆位牌義：${card.reversed}</h3>
                            <p class="text-gray-300 leading-relaxed">${card.reversed_full || '詳細說明待補充。'}</p>
                        </div>
                    </div>
                </div>`;
            document.getElementById('card-modal').classList.remove('hidden');
        }

        function drawCards() {
            if (!currentSpread) return;

            const shuffledDeck = [...allCards].sort(() => Math.random() - 0.5);
            
            const numCards = currentSpread === 'cause-effect' ? 2 : 3;
            drawnCardsData = [];

            for (let i = 0; i < numCards; i++) {
                const card = shuffledDeck.pop();
                const isReversed = Math.random() < 0.5;
                drawnCardsData.push({ ...card, isReversed });
            }

            displayReadingResult();
        }

        function displayReadingResult() {
            const readingResultDiv = document.getElementById('reading-result');
            const drawnCardsDiv = document.getElementById('drawn-cards');
            const resultTitle = document.getElementById('result-title');
            const analysisResultDiv = document.getElementById('analysis-result');
            
            drawnCardsDiv.innerHTML = '';
            
            let labels = [];
            if (currentSpread === 'cause-effect') {
                resultTitle.textContent = '您的「因果牌陣」抽牌結果';
                labels = ['原因 (因)', '結果 (果)'];
            } else {
                resultTitle.textContent = '您的「時間之流牌陣」抽牌結果';
                labels = ['過去', '現在', '未來'];
            }

            drawnCardsData.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'text-center w-28 md:w-40 flex-shrink-0';
                cardElement.innerHTML = `
                    <p class="font-semibold text-lg mb-2 text-indigo-300">${labels[index]}</p>
                    <img src="${card.img}" alt="${card.name}" 
                         class="card-image shadow-lg cursor-pointer transform hover:scale-105 transition-transform duration-300 ${card.isReversed ? 'rotate-180' : ''}"
                         onclick="showCardDetails('${card.name}')">
                    <p class="mt-2 font-semibold text-gray-200">${card.name} ${card.isReversed ? '(逆位)' : '(正位)'}</p>
                `;
                drawnCardsDiv.appendChild(cardElement);
            });
            
            let analysisHTML = '<h3 class="text-2xl font-bold text-center mb-6 text-yellow-300">詳細占卜分析</h3>';
            drawnCardsData.forEach((card, index) => {
                const fullCard = getFullCardData(card.name);
                const meaning_keywords = card.isReversed ? fullCard.reversed : fullCard.upright;
                const meaning_full = card.isReversed ? (fullCard.reversed_full || '詳細說明待補充。') : (fullCard.upright_full || '詳細說明待補充。');

                analysisHTML += `
                    <div class="mb-6 pb-6 border-b border-gray-700">
                        <h4 class="text-xl font-bold text-indigo-300 mb-2">${labels[index]}：${card.name} ${card.isReversed ? '(逆位)' : '(正位)'}</h4>
                        <div class="space-y-2 text-gray-300">
                           <p>${fullCard.concept}</p>
                           <p><b>牌義關鍵字：</b>${meaning_keywords}</p>
                           <p>${meaning_full}</p>
                        </div>
                    </div>
                `;
            });

            analysisHTML += `
                <div class="mt-6">
                    <h4 class="text-xl font-bold text-indigo-300 mb-2">綜合解讀提示</h4>
                    <p class="text-gray-400">解牌的核心是將抽出的牌卡串連成一個與提問相關的故事。請試著將以上牌義整合成一個連貫的敘述，思考它們如何共同回答您心中的問題。</p>
                </div>
            `;

            analysisResultDiv.innerHTML = analysisHTML;
            readingResultDiv.classList.remove('hidden');
            
            readingResultDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function sendEmail() {
            const emailInput = document.getElementById('email-input');
            const sendBtn = document.getElementById('send-email-btn');
            const emailStatus = document.getElementById('email-status');

            if (!emailInput.value || !/^\S+@\S+\.\S+$/.test(emailInput.value)) {
                emailStatus.textContent = '請輸入有效的電子信箱格式。';
                emailStatus.style.color = '#f87171'; // Red
                return;
            }

            if (drawnCardsData.length === 0) {
                emailStatus.textContent = '請先抽牌後再寄送報告。';
                emailStatus.style.color = '#facc15'; // Yellow
                return;
            }

            sendBtn.disabled = true;
            sendBtn.textContent = '寄送中...';
            emailStatus.textContent = '';
            
            const spreadName = currentSpread === 'cause-effect' ? '因果牌陣' : '時間之流牌陣';
            
            let labels = [];
            if (currentSpread === 'cause-effect') {
                labels = ['原因 (因)', '結果 (果)'];
            } else {
                labels = ['過去', '現在', '未來'];
            }

            let drawnCardsHtml = '<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr>';
            drawnCardsData.forEach((card, index) => {
                drawnCardsHtml += `
                    <td align="center" style="padding: 10px; vertical-align: top; width: ${100/labels.length}%;">
                        <p style="font-size: 16px; font-weight: 600; color: #a5b4fc; margin: 0 0 8px 0; font-family: 'Noto Serif TC', Georgia, serif;">${labels[index]}</p>
                        <img src="${card.img}" alt="${card.name}" width="120" style="border-radius: 8px; ${card.isReversed ? 'transform: rotate(180deg);' : ''}">
                        <p style="font-size: 16px; font-weight: 600; color: #e5e7eb; margin: 8px 0 0 0; font-family: 'Noto Serif TC', Georgia, serif;">${card.name} ${card.isReversed ? '(逆位)' : ''}</p>
                    </td>
                `;
            });
            drawnCardsHtml += '</tr></table>';

            let analysisDetailHtml = '';
            drawnCardsData.forEach((card, index) => {
                const fullCard = getFullCardData(card.name);
                const meaning_keywords = card.isReversed ? fullCard.reversed : fullCard.upright;
                const meaning_full = card.isReversed ? (fullCard.reversed_full || '詳細說明待補充。') : (fullCard.upright_full || '詳細說明待補充。');

                analysisDetailHtml += `
                    <div style="margin-bottom: 24px; padding-bottom: 24px; border-bottom: 1px solid #4b5563;">
                        <h3 style="font-size: 20px; font-weight: 600; color: #a5b4fc; font-family: 'Noto Serif TC', Georgia, serif; margin: 0 0 8px 0;">${labels[index]}：${card.name} ${card.isReversed ? '(逆位)' : '(正位)'}</h3>
                        <div style="color: #d1d5db; line-height: 1.7;">
                           <p style="margin: 0 0 8px 0;">${fullCard.concept}</p>
                           <p style="margin: 0 0 8px 0;"><b>牌義關鍵字：</b>${meaning_keywords}</p>
                           <p style="margin: 0;">${meaning_full}</p>
                        </div>
                    </div>
                `;
            });
            
            const templateParams = {
                to_email: emailInput.value,
                spread_name: spreadName,
                drawn_cards_html: drawnCardsHtml,
                analysis_detail_html: analysisDetailHtml
            };

            emailjs.send('service_tu3puek', 'template_pexhwes', templateParams)
                .then(function(response) {
                   emailStatus.textContent = '分析報告已成功寄送！';
                   emailStatus.style.color = '#4ade80'; // Green
                   sendBtn.textContent = '重新占卜';
                   const newBtn = sendBtn.cloneNode(true);
                   sendBtn.parentNode.replaceChild(newBtn, sendBtn);
                   newBtn.addEventListener('click', () => window.location.reload());

                }, function(error) {
                   emailStatus.textContent = '寄送失敗，請檢查 EmailJS 模板變數設定。';
                   emailStatus.style.color = '#f87171'; // Red
                   sendBtn.disabled = false;
                   sendBtn.textContent = '寄送報告';
                });
        }
    </script>

</body>
</html>

